---
import Placeholder from './ui/Placeholder.astro';
import SearchArchitecture from './diagrams/SearchArchitecture';

const features = [
	{
		id: "knowledge-grafting",
		title: "Knowledge Grafting",
		subtitle: "Feed the Soil",
		description: "Drag and drop PDFs or text files directly into a conversation. BonsAI grafts documents to specific chat contexts, allowing you to query your private data securely. Your sensitive financial docs or draft manuscripts never leave your machine.",
		media: { type: "video", src: "/RAG-Web.mp4", caption: "Fig 2: Local RAG. No upload bars. No cloud processing.", objectPosition: "center 60%" },
		align: "right"
	},
	{
		id: "bio-card",
		title: "The Bio-Card",
		subtitle: "A Living Record",
		description: "Cloud AI collects your data to personalize your experience—for their benefit. BonsAI keeps it local.<br/><br/>The Bio-Card is where you define who you are. Your background, preferences, and context travel with every conversation—no repetitive introductions required.",
		media: { type: "video", src: "/Bio-Card-Web.mp4", caption: "Fig 2: The Bio-Card identity layer." },
		align: "left"
	},
	{
		id: "saplings",
		title: "Saplings",
		subtitle: "Grow Your Personas",
		description: "Grow distinct Personas for different tasks—a 'Junior Dev' for coding, a 'Plot Architect' for writing. Each Sapling carries its own distinct personality and conversation history, letting you switch contexts without losing focus.",
		media: { type: "video", src: "/Sapling-Web.mp4", caption: "Fig 3: The Saplings personalization engine.", objectPosition: "center bottom" },
		align: "right"
	},
	{
		id: "privacy-search",
		title: "Privacy Search",
		subtitle: "Forage Responsibly",
		description: "Sometimes the answer isn't on your hard drive. BonsAI includes a private, scraper-based search tool. It fetches live data from the web without using tracked APIs or exposing your identity to Big Tech. You open the airlock, fetch the data, and seal it shut.",
		media: { type: "video", src: "/Search-Web.mp4", caption: "Fig 4: Anonymous search fetching live web data.", objectPosition: "center bottom" },
		align: "left"
	}
];
---

<section class="py-24 px-4 space-y-32">
    {features.map((feature, index) => (
        <div id={feature.id} class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-12 md:gap-20 items-center">
            {/* Text Side */}
            <div class:list={["space-y-6", feature.align === 'right' ? 'md:order-2' : 'md:order-1']}>
                
                <h3 class="font-heading font-bold text-4xl text-charcoal-ink">
                    {feature.title}
                </h3>
                <h4 class="font-heading font-medium text-2xl text-terracotta italic mb-4">
                    {feature.subtitle}
                </h4>
                
                <div class="prose prose-lg text-charcoal-ink/90 font-body leading-relaxed" set:html={feature.description}></div>
            </div>

            {/* Media Side */}
            <div class:list={["w-full", feature.align === 'right' ? 'md:order-1' : 'md:order-2']}>
                {feature.media && (
                    <Placeholder 
                        type={feature.media.type as any} 
                        src={(feature.media as any).src}
                        objectPosition={(feature.media as any).objectPosition}
                        caption={feature.media.caption} 
                        class="w-full transform transition-all duration-700 hover:scale-[1.01]"
                    />
                )}
                {!feature.media && (
                    <SearchArchitecture client:visible />
                )}
            </div>
        </div>
    ))}
</section>
